{% extends "layout.html" %}
{% block content %}
<div class="container">
  <div class="bg-light p-5 rounded mb-4">
    <h1>Pron√≥stico de Probabilidad de Robo (Robbery Probability Forecast)</h1>
    <p class="lead">Configura las condiciones para estimar la probabilidad de que un incidente sea un robo. (Set the conditions to estimate the probability of an incident being a robbery.)</p>
  </div>

  <div class="row">
    <div class="col-md-5">
      <h3>Configura las Condiciones (Set Conditions)</h3>
      <div class="card p-4">
        <form method="POST" action="/forecast">
          <div class="mb-3">
            <label for="borough" class="form-label fw-bold">üìç Distrito (Borough)</label>
            <select class="form-select" id="borough" name="borough">
              {% for b in boroughs %}
                <option value="{{ b }}" {% if input_values.borough == b %}selected{% endif %}>{{ b }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="mb-3">
            <label for="day_of_week" class="form-label">üóìÔ∏è D√≠a de la Semana (Day of the Week)</label>
            <select class="form-select" id="day_of_week" name="day_of_week">
              {% for day in days %}
                <option value="{{ day }}" {% if input_values.day_of_week == day %}selected{% endif %}>{{ day }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="mb-3">
            <label for="hour" class="form-label">‚è∞ Hora del D√≠a (Hour): <span id="hour-value" class="fw-bold">{{ input_values.hour or 12 }}</span>:00</label>
            <input type="range" class="form-range" id="hour" name="hour" min="0" max="23" value="{{ input_values.hour or 12 }}" oninput="document.getElementById('hour-value').innerText = this.value;">
          </div>
          <div class="mb-3">
            <label for="premise_type" class="form-label">üè¢ Tipo de Lugar (Premise Type)</label>
            <select class="form-select" id="premise_type" name="premise_type">
              {% for premise in premise_types %}
                <option value="{{ premise }}" {% if input_values.prem_typ_desc == premise %}selected{% endif %}>{{ premise }}</option>
              {% endfor %}
            </select>
          </div>
          <button type="submit" class="btn btn-primary w-100 mt-3">Predecir Probabilidad (Predict Probability)</button>
        </form>
      </div>
    </div>

    <div class="col-md-7">
      <h3>Nivel de Riesgo (Risk Level)</h3>
      <div class="card p-4 text-center">
        {% if probability %}
          {% set prob_float = probability|float %}
          {% if prob_float > 20 %}
            {% set color = 'danger' %}
            {% set risk_level = 'ALTO' %}
          {% elif prob_float > 10 %}
            {% set color = 'warning' %}
            {% set risk_level = 'MODERADO' %}
          {% else %}
            {% set color = 'success' %}
            {% set risk_level = 'BAJO' %}
          {% endif %}

          <h5 class="mb-3">Probabilidad de Robo:</h5>
          <h1 class="display-1 fw-bold text-{{ color }}">{{ probability }}%</h1>
          <div class="progress mt-3" style="height: 40px;">
            <div class="progress-bar bg-{{ color }} progress-bar-striped progress-bar-animated" role="progressbar" style="width: {{ probability }}%;" aria-valuenow="{{ probability }}" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
          <p class="mt-3 fs-4">El nivel de riesgo es <strong class="text-{{ color }}">{{ risk_level }}</strong>.</p>
        
        {% else %}
          <div class="alert alert-info">
            <p class="mb-0">Ajusta los valores y haz clic en "Predecir" para ver el nivel de riesgo. (Adjust values and click "Predict" to see the risk level.)</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}